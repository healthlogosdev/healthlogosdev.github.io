<!DOCTYPE html>
<html>
    <body>
        <h1>On your way to Login with Amazon</h1>
        <p>Enjoy the ride.</p>
        <p>I'm hosted with GitHub Pages.</p>
        <script type="text/javascript">
            //compose url
            // first get the state
            var state = "777"	
            var redir = "https://www.amazon.com/ap/oa?client_id=amzn1.application-oa2-client.b7a978f5efc248a098d2c0588dfb8392&scope=profile&response_type=code&redirect_uri=https://logoshealth.github.io/complete.html"
            
            //redirect to URL
            window.location.href = redir;            
            window.addEventListener("popstate", sendMessage);
            
                function getParameterByName(name, url) {
                //SHAMELESSLY BORROWED FROM STACK OVERFLOW
                //SHAMELESSLY BORROWED FROM The YittishNinja
                if (!url) url = window.location.href;
                    name = name.replace(/[\[\]]/g, "\\$&");
                    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
                    results = regex.exec(url);
                    if (!results) return null;
                    if (!results[2]) return '';
                    return decodeURIComponent(results[2].replace(/\+/g, " "));
                }
            
                function sendMessage() {
                    if (window.location.href.includes("code=")) {
                        window.opener.postMessage(window.location.href, "http://localhost:8080");
                    }
                }
        </script>
    </body>
</html>
